<% layout("/layouts/boilerplate.ejs") %>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
 :root {
   --primary: #0d6efd;
   --primary-light: #667eea;
   --primary-dark: #0a58ca;
   --success: #198754;
   --success-light: #11998e;
   --success-dark: #059669;
   --danger: #dc3545;
   --danger-light: #ef4444;
   --warning: #ffc107;
   --dark: #212529;
   --light: #f8f9fa;
 }

 body {
   background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
   min-height: 100vh;
   font-family: 'Inter', sans-serif;
 }

 .main-content {
   background: white;
   border-radius: 16px;
   padding: 30px;
   box-shadow: 0 10px 30px rgba(0,0,0,0.15);
 }

 .header-actions {
   background: white;
   border-radius: 16px;
   padding: 20px;
   margin-bottom: 24px;
   box-shadow: 0 8px 20px rgba(0,0,0,0.1);
   display: flex;
   justify-content: space-between;
   align-items: center;
 }

 h2 {
   color: var(--dark);
   font-weight: 700;
   margin: 0;
 }

 .btn {
   border-radius: 12px;
   padding: 10px 20px;
   font-weight: 600;
   text-decoration: none;
   border: none;
 }

 .btn-success {
   background: linear-gradient(135deg, var(--success-light), var(--success-dark));
   color: white;
   transition: all 0.3s ease;
 }

 .btn-success:hover {
   transform: translateY(-2px);
   box-shadow: 0 6px 14px rgba(17, 153, 142, 0.3);
 }

 /* Table Styling */
 .table-container {
   background: white;
   border-radius: 16px;
   overflow: hidden;
   box-shadow: 0 10px 25px rgba(0,0,0,0.1);
 }

 .table {
   margin: 0;
   border-collapse: separate;
   border-spacing: 0;
 }

 .table thead th {
   background: linear-gradient(135deg, var(--primary-light), var(--primary-dark));
   color: white;
   padding: 18px;
   border: none;
   font-weight: 600;
   text-transform: uppercase;
   letter-spacing: 0.5px;
   font-size: 14px;
 }

 .table td {
   padding: 16px;
   border-bottom: 1px solid #e9ecef;
   vertical-align: middle;
   font-size: 14px;
 }

 .table tbody tr {
   transition: all 0.3s ease;
 }

 .table tbody tr:hover {
   background: #f8f9fa;
   transform: scale(1.01);
   box-shadow: 0 5px 15px rgba(0,0,0,0.08);
 }

 .status-badge {
   padding: 6px 12px;
   border-radius: 50px;
   font-size: 12px;
   font-weight: 600;
   text-transform: uppercase;
   letter-spacing: 0.5px;
   box-shadow: 0 2px 5px rgba(0,0,0,0.1);
 }

 .status-active {
   background: linear-gradient(135deg, #10b981, #059669);
   color: white;
 }

 .status-inactive {
   background: linear-gradient(135deg, #fbbf24, #f59e0b);
   color: white;
 }

 .price-cell {
   font-weight: 600;
   color: #16a34a;
 }

 .stock-low {
   background: linear-gradient(135deg, #ef4444, #dc2626);
   color: white;
   padding: 4px 10px;
   border-radius: 50px;
   font-size: 12px;
   font-weight: 600;
 }

 .stock-ok {
   background: linear-gradient(135deg, #10b981, #059669);
   color: white;
   padding: 4px 10px;
   border-radius: 50px;
   font-size: 12px;
   font-weight: 600;
 }

 .btn-sm {
   padding: 6px 12px;
   font-size: 14px;
   border-radius: 10px;
 }

 .btn-primary {
   background: linear-gradient(135deg, #667eea, #764ba2);
   color: white;
   transition: all 0.3s ease;
 }

 .btn-primary:hover {
   transform: translateY(-2px);
   box-shadow: 0 6px 14px rgba(102, 126, 234, 0.3);
 }

 .btn-danger {
   background: linear-gradient(135deg, #ef4444, #dc2626);
   color: white;
   transition: all 0.3s ease;
 }

 .btn-danger:hover {
   transform: translateY(-2px);
   box-shadow: 0 6px 14px rgba(239, 68, 68, 0.3);
 }

 /* Responsive */
 @media (max-width: 768px) {
   .header-actions {
     flex-direction: column;
     align-items: stretch;
     gap: 12px;
   }

   .table, thead, tbody, th, td, tr {
     display: block;
   }

   thead {
     display: none;
   }

   tr {
     margin-bottom: 16px;
     padding: 16px;
     border: 2px solid #e9ecef;
     border-radius: 12px;
   }

   td {
     display: flex;
     justify-content: space-between;
     padding: 8px 0;
     border: none;
   }

   td::before {
     content: attr(data-label) ": ";
     font-weight: 600;
     min-width: 100px;
     color: var(--dark);
   }
 }
</style>

<div class="container-fluid" style="padding-top: 170px;">
  <div class="row">
    <%- include("partials/sidebar") %>

    <div class="col-md-10 p-4">
      <div class="main-content animate__animated animate__fadeIn">

        <!-- Header with Add Button -->
        <div class="header-actions animate__animated animate__fadeInUp">
          <h2><i class="fas fa-box-open me-2"></i> Products</h2>
          <a href="/admin/products/new" class="btn btn-success">
            <i class="fas fa-plus me-1"></i> Add Product
          </a>
        </div>

        <!-- Products Table -->
        <div class="table-container animate__animated animate__fadeIn animate__delay-1s">
          <table class="table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Price (₹)</th>
                <th>Category</th>
                <th>Stock</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <% products.forEach((product, idx) => { %>
                <tr class="animate__animated animate__fadeInUp" style="animation-delay: <%= (idx * 0.1) + 0.6 %>s">
                  <td data-label="Name"><strong><%= product.name %></strong></td>
                  <td data-label="Price (₹)" class="price-cell">₹ <%= product.price %></td>
                  <td data-label="Category"><%= product.category %></td>
                  <td data-label="Stock">
                    <span class="stock-<%= product.stock <= 10 ? 'low' : 'ok' %>">
                      <%= product.stock %>
                    </span>
                  </td>
                  <td data-label="Status">
                    <span class="status-badge status-<%= product.status === 'Active' ? 'active' : 'inactive' %>">
                      <%= product.status %>
                    </span>
                  </td>
                  <td data-label="Actions" style="white-space: nowrap;">
                    <a class="btn btn-primary btn-sm" href="/admin/products/<%= product._id %>/edit">
                      <i class="fas fa-edit me-1"></i> Edit
                    </a>
                    <form method="POST" action="/admin/products/<%= product._id %>/delete" style="display:inline;" onsubmit="return confirm('Delete this product?')">
                      <button class="btn btn-danger btn-sm">
                        <i class="fas fa-trash me-1"></i> Delete
                      </button>
                    </form>
                  </td>
                </tr>
              <% }) %>
            </tbody>
          </table>
        </div>

      </div>
    </div>
  </div>
</div>
